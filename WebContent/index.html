<!DOCTYPE html>
<html>
<head>
    <title>Kraplow! The unofficial western card game clone</title>
    <script>
        function copyToClipboard() {
            const copyText = document.getElementById("joinurl");
            copyText.select();
            document.execCommand("Copy");
        }
    </script>
    <script type="module">
        import {stateMachine} from "./js/statemachine.js";
        import {sendApiRequest, getServletUrl} from "./js/sendApiRequest.js";
        import {getCookie} from "./js/cookie.js";
        import {countPlayers, parseCountPlayers} from "./js/countPlayers.js"
        import {parseGetAvailableGame, getAvailableGame} from "./js/availableGame.js"
        import {getGuestCounter, parseGetGuestCounter} from "./js/guestCounter.js"
        import {join, joinAi, parseJoinAi, parseJoin} from "./js/join.js"
        import {leave, parseLeaveAI, parseLeave} from "./js/leave.js"
        import {getDescriptionForPlayer, getImageForPlayer, playerInfo, getImageForRole} from "./js/playerInfo.js"
        import {getDescriptionForCard, getImageForCard} from "./js/cardInfo.js"
        import {getChat, sendChat, parseSendChat, parseGetChat} from "./js/chat.js"
        import {timedCount} from "./js/timedCount.js"
        import {sendResponseJson, parseSendResponse} from "./js/response.js"
        import {getPlayerInfo, parseGetPlayerInfo} from "./js/playerInfoApi.js"
        import {generateTargetCodeSingle, generateTargetCode} from "./js/generateCodes.js"
        import {parseGetGameState, getGameState} from "./js/gameState.js"
        import {flashBorder} from "./js/flashBorder.js"
        import {create, parseCreate, addRobot} from "./js/create.js"
        import {commandName} from "./js/commandName.js"
        import {start, canStart, parseCanStart, parseStart, writeInfo} from "./js/start.js"
        import {setup} from "./js/setup.js"
        import {pollMessages, formatMessage, getMessage, parseGetMessage} from "./js/message.js"
        window.addEventListener('load', () => timedCount());
        document.querySelector('#chatInputForm').addEventListener('submit', () => {sendChat(document.getElementById('chatinput').value); document.getElementById('chatinput').value = ''; return false;})
        document.querySelector('#chatInputSubmit').addEventListener('click', () => {sendChat(document.getElementById('chatinput').value); document.getElementById('chatinput').value = '';})
    </script>
    <script src="./js/sendApiRequest.js" type="module"></script>
    <script src="./js/cookie.js" type="module"></script>
    <script src="./js/countPlayers.js" type="module"></script>
    <script src="./js/availableGame.js" type="module"></script>
    <script src="./js/guestCounter.js" type="module"></script>
    <script src="./js/join.js" type="module"></script>
    <script src="./js/leave.js" type="module"></script>
    <script src="./js/playerInfo.js" type="module"></script>
    <script src="./js/cardInfo.js" type="module"></script>
    <script src="./js/chat.js" type="module"></script>
    <script src="./js/timedCount.js" type="module"></script>
    <script src="./js/response.js" type="module"></script>
    <script src="./js/playerInfoApi.js" type="module"></script>
    <script src="./js/generateCodes.js" type="module"></script>
    <script src="./js/gameState.js" type="module"></script>
    <script src="./js/flashBorder.js" type="module"></script>
    <script src="./js/create.js" type="module"></script>
    <script src="./js/commandName.js" type="module"></script>
    <script src="./js/start.js" type="module"></script>
    <script src="./js/setup.js" type="module"></script>
    <script src="./js/message.js" type="module"></script>
    <script src="./js/main.js" type="module"></script>
</head>
<body style="background:url(wood.jpg) repeat;">
<div>
    <div id="gameSetup"></div>
    <div id="gameState" style="float:left;"></div>
    <div id="gameInfo">
        <p> Private:
            <input type="checkbox" id="private" name="private" value="private"/>
        </p>
        <p> AI Speed - Instant:
            <input type="radio" id="aiSpeedInstant" name="aiSpeed" value="0"/>
            Fast:
            <input type="radio" id="aiSpeedFast" name="aiSpeed" value="1500" checked="checked"/>
            Slow:
            <input type="radio" id="aiSpeedSlow" name="aiSpeed" value="3500"/>
        </p>
        <p> Expansion Sidestep Township - 4-8 players (Beta):
            <input type="checkbox" id="sidestep" name="sidestep" value="sidestep"/>
            Status: Everything Implemented, still needs some wording. I'm sure it has bugs.
        </p>
        <p> Kraplow! is a clone of western card game A Casual, Western Action Card Game with Secret Role, and Proximity
            elements. Kraplow! implements all rules and official FAQ answers of western card game No expansions are
            implemented.
        </p>
        <div>
            <form>Handle <input type="text" name="handle" id="handle"/></form>
        </div>
    </div>
    <div style="float:left;">
        <div>
            <div style="float:left;" id="chatLog"></div>
            <div style="float:left; width:100px; height:178px;" id="chatNames"></div>
        </div>
        <div id="chatInputDiv">
<!--            refactor: what is this?-->
            <form id="chatInputForm">
                Chat
                <input type="text" id="chatinput">
                <input id="chatInputSubmit" type="button" value="Send">
            </form>
        </div>
        <div><textarea id="gameLog" rows='10' cols='60' style="display:none;" readonly></textarea></div>
        <div id="gameMessages" style="height:256px; width:533px; display:none; border:2px solid #000;"></div>
        <div id="remainingroles"></div>
    </div>
    <div style="clear:both;"></div>
    <div id="handArea"></div>
    <a href="legend.html" target="_blank">Show Legend</a>
    <a href="mailto:ccarrster@gmail.com">ccarrster@gmail.com</a>
    <a href="http://kraplow.freeforums.net" target="_blank">Forum</a>
    <a target="_blank" href="https://github.com/ccarrster/kraplow">Github Project</a>
    <div>Thank you to
        <a target="_blank" href="https://www.instagram.com/valevidart/">Valentina Conte</a>
        and
        <a href="https://www.instagram.com/myriam_art_designs" target="_blank">Myriam Salvado</a>
        for some beautiful artwork and Lestodante for the layout/editing pictures.
    </div>
</div>
<audio id="myAudio" src="sounds/Clay Pigeons Instrumental Demo.mp3" controls="controls">
</audio>
<div>Try out the new music, credits to follow.</div>
<script>
    //One loop
    const music = ["sounds/Clay Pigeons Instrumental Demo.mp3", "sounds/Kraplow Soundscape.mp3", "sounds/Kraplow1.mp3", "sounds/Renegade Demo.mp3", "sounds/Saloon Demo.mp3"];
    (function () {
        myAudio = document.getElementById("myAudio");
        //myAudio.play();
        //Auto play does not work
        myAudio.addEventListener('ended', playEnded, false);
    })();

    function playEnded() {
        const nextSong = music.pop();
        myAudio.src = nextSong;
        music.unshift(nextSong);
        myAudio.play();
    }
</script>
</body>
</html>